Bridge.Class.define("Demo.BootstrapApp",{statics:{config:{init:function(){$(this.main)}},main:function(){document.body.style.padding="20px";$("<form>").addClass("col-md-6").append(Demo.BootstrapApp.createPanel()).appendTo(document.body);Demo.BootstrapApp.updateButton_Click(null);Demo.BootstrapApp.listenToBootstrapEvents()},createPanel:function(){return $("<div>").addClass("panel panel-default").append(Demo.BootstrapApp.createPanelHeader()).append(Demo.BootstrapApp.createPanelBody()).append(Demo.BootstrapApp.createPanelFooter())},createPanelHeader:function(){return $("<div>").addClass("panel-heading logo").append($("<h1>").html("Bridge.NET Bootstrap Demo"))},createPanelBody:function(){return $("<div>").addClass("panel-body collapse in").append(Demo.BootstrapApp.createFormField("Name","user")).append(Demo.BootstrapApp.createFormField("Email","globe")).append(Demo.BootstrapApp.createFormField("Message","pencil")).append(Demo.BootstrapApp.createDateTimeField())},createPanelFooter:function(){return $("<div>").addClass("panel-footer text-right").append(Demo.BootstrapApp.createProcessButton()).append($(Bridge.merge(document.createElement("button"),{className:"btn btn-primary",innerHTML:"Collapse",style:{marginRight:"10px"}})).on("click",function(n){$(".panel-body").collapse("toggle");$(this).text($(this).text()==="Collapse"?"Expand":"Collapse");n.preventDefault()})).append($(Bridge.merge(document.createElement("button"),{className:"btn btn-primary",innerHTML:"Toggle Tooltips and Popovers",style:{marginRight:"10px"}})).on("click",function(n){$('[rel="popover"]').popover("toggle");$('[rel="tooltip"]').tooltip("toggle");n.preventDefault()})).append($(Bridge.merge(document.createElement("input"),{type:"submit",value:"Submit",className:"btn btn-success",formAction:Demo.Config.SUBMIT_URL,formMethod:"POST"})).attr("rel","tooltip"))},createProcessButton:function(){return $(Bridge.merge(document.createElement("button"),{className:"btn btn-primary",innerHTML:"Async Process",style:{marginRight:"10px"}})).on("click",function(n){var t=0,i,f,r,n,e,o,s,h,c,l,u=function(){for(;;)switch(t){case 0:n.preventDefault();Demo.BootstrapApp.createModalWithProgressBar().appendTo(document.body).modal({backdrop:"static"});e=0;o=$(".modal-title");s=window.setInterval(function(){var n=e++%20*10;$(".progress-bar").attr("aria-valuenow",n).attr("style","width:"+n+"%;");o.html("Long running process: "+n+"% complete")},490);i=Bridge.Task.fromPromise($.ajax({url:Demo.Config.LONG_RUNNING_PROCESS,cache:!1}),function(){return arguments[0].toString()});t=1;i.continueWith(u);return;case 1:if(f=i.getResult(),h=f,c=JSON.parse(h),c==="ok"){window.clearInterval(s);$(".progress-bar").attr("aria-valuenow",100).attr("style","width: 100%;").html("Done");$(".modal-title").html("Success!");r=Bridge.Task.delay(2e3);t=2;r.continueWith(u);return}t=3;continue;case 2:r.getResult();l=$(".modal").on("hidden.bs.modal",function(){$(this).remove()}).modal("hide");t=3;continue;case 3:return;default:return}};u()})},createModalWithProgressBar:function(){return $("<div>").addClass("modal fade").append($("<div>").addClass("modal-dialog").append($("<div>").addClass("modal-content").append($("<div>").addClass("modal-header").append($("<h4>").addClass("modal-title").html("Long running process..."))).append($("<div>").addClass("modal-body").append($("<div>").addClass("progress").append($("<div>").addClass("progress-bar").attr("role","progressbar").attr("aria-valuemin","0").attr("aria-valuemax","100"))))))},createFormField:function(n,t){var i,r=n+"...";return i=n==="Message"?Bridge.merge(document.createElement("textarea"),{name:n.toLowerCase(),placeholder:r,required:!0,className:"form-control"}):Bridge.merge(document.createElement("input"),{type:"text",name:n.toLowerCase(),placeholder:r,required:!0,className:"form-control"}),$("<div>").addClass("input-group").css("margin-bottom","10px").append(Bridge.merge(document.createElement("span"),{className:"glyphicon glyphicon-"+t+" input-group-addon"})).append($(i).attr("rel","tooltip").tooltip({title:"Required Field",container:"body",placement:"right"}))},createDateTimeField:function(){return[Bridge.merge(document.createElement("label"),{htmlFor:"dateTimeInput",innerHTML:"Server Date and Time:"}),$(Bridge.merge(document.createElement("div"),{className:"input-group"})).append(Bridge.merge(document.createElement("span"),{className:"input-group-addon glyphicon glyphicon-time"})).append($(Bridge.merge(document.createElement("input"),{id:"dateTimeInput",type:"text",className:"form-control",readOnly:!0,name:"datetime"})).attr("rel","popover").popover({content:"This is a ReadOnly Field",container:"body",trigger:"hover",placement:"top"})).append($(Bridge.merge(document.createElement("span"),{className:"input-group-btn"})).append($(Bridge.merge(document.createElement("button"),{type:"button",className:"btn btn-primary",innerHTML:'<span class="glyphicon glyphicon-refresh"><\/span>'})).attr("data-loading-text","Loading...").attr("rel","popover").on("click",Demo.BootstrapApp.updateButton_Click).popover({title:"Get the server Date and Time",content:"Clicking this Button initiates an AJAX request to the server",container:"body",trigger:"hover"})))]},updateButton_Click:function(n){var u=0,i,t,r,f=function(){for(;;)switch(u){case 0:t=null;r=0;n!==null&&(t=$(n.currentTarget),t.button("loading"),r=2e3);i=Bridge.Task.delay(r);u=1;i.continueWith(f);return;case 1:i.getResult();$.ajax({url:Demo.Config.GET_SERVER_TIME_URL,cache:!1,success:function(n){t!==null&&t.button("reset");var i=JSON.parse(Bridge.cast(n,String)),r=Bridge.Date.parse(i);$("#dateTimeInput").val(Bridge.Date.format(r,"yyyy-MM-dd hh:mm:ss"))}});return;default:return}};f()},showAlert:function(n){var t=$("<div>").addClass("alert alert-info col-md-4").attr("role","alert").attr("style","display: block; position: relative;").html(n).appendTo(document.body);window.setTimeout(function(){return t.remove()},3e3)},listenToBootstrapEvents:function(){$(".collapse").on("hidden.bs.collapse",function(){Demo.BootstrapApp.showAlert("The Panel's body has been collapsed")}).on("shown.bs.collapse",function(){return Demo.BootstrapApp.showAlert("The Panel's body has been expanded")})}}})